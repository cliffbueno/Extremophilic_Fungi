p_bac <- insert_yaxis_grob(p3, p4, position = "right")
p4
p2
p4
p5 <- ggplot(data = fun_bray_df_long, aes(comparison, value, colour = comparison)) +
geom_jitter(size = 0.5, alpha = 0.01) +
geom_boxplot(aes(comparison, value), outlier.shape = NA, color = "black",
fill = NA, inherit.aes = F) +
geom_text(data = label.df, aes(x = comparison, y = Value, label = Sig, group = NULL),
inherit.aes = F) +
scale_colour_manual(values = brewer.pal(6, "Paired")[5:6]) +
labs(x = "Environment comparison",
y = "Bray-Curtis dissimilarity") +
ylim(0,1.05) +
theme_bw() +
theme(plot.margin = unit(c(0.1,0.1,0.1,0.1),"cm"),
legend.position = "none")
p6 <- ggdensity(fun_bray_df_long, "value", fill = "comparison",
palette = c(brewer.pal(6, "Paired")[5:6]), size = 0.25) +
rotate() +
clean_theme() +
rremove("legend") +
xlim(0.55, 1.05)
p6
p_fun <- insert_yaxis_grob(p5, p6, position = "right")
g1 <- ggdraw(p_arc)
g2 <- ggdraw(p_bac)
g3 <- ggdraw(p_fun)
png("FigsUpdated/CompareBrayCurtis_wDensity.png", width = 9, height = 3, units = "in", res = 300)
plot_grid(g1, g2, g3, labels = c("a) Archaea", "b) Bacteria", "c) Fungi"))
dev.off()
p3 <- ggplot(data = fun_bray_df_long, aes(comparison, value, colour = comparison)) +
geom_jitter(size = 0.5, alpha = 0.01) +
geom_boxplot(aes(comparison, value), outlier.shape = NA, color = "black",
fill = NA, inherit.aes = F) +
geom_text(data = label.df, aes(x = comparison, y = Value, label = Sig, group = NULL),
inherit.aes = F) +
scale_colour_manual(values = brewer.pal(6, "Paired")[3:4]) +
labs(x = "Environment comparison",
y = "Bray-Curtis dissimilarity") +
ylim(0,1.05) +
theme_bw() +
theme(plot.margin = unit(c(0.1,0.1,0.1,0.1),"cm"),
legend.position = "none",
axis.title.y = element_blank(),
axis.text.y = element_blank())
p_bac <- insert_yaxis_grob(p3, p4, position = "right")
p5 <- ggplot(data = fun_bray_df_long, aes(comparison, value, colour = comparison)) +
geom_jitter(size = 0.5, alpha = 0.01) +
geom_boxplot(aes(comparison, value), outlier.shape = NA, color = "black",
fill = NA, inherit.aes = F) +
geom_text(data = label.df, aes(x = comparison, y = Value, label = Sig, group = NULL),
inherit.aes = F) +
scale_colour_manual(values = brewer.pal(6, "Paired")[5:6]) +
labs(x = "Environment comparison",
y = "Bray-Curtis dissimilarity") +
ylim(0,1.05) +
theme_bw() +
theme(plot.margin = unit(c(0.1,0.1,0.1,0.1),"cm"),
legend.position = "none",
axis.title.y = element_blank(),
axis.text.y = element_blank())
p_fun <- insert_yaxis_grob(p5, p6, position = "right")
g2 <- ggdraw(p_bac)
g3 <- ggdraw(p_fun)
png("FigsUpdated/CompareBrayCurtis_wDensity.png", width = 9, height = 3, units = "in", res = 300)
plot_grid(g1, g2, g3,
ncol = 3,
labels = c("a) Archaea", "b) Bacteria", "c) Fungi"),
rel_widths = c(0.4, 0.3, 0.3))
dev.off()
p3 <- ggplot(data = bac_bray_df_long, aes(comparison, value, colour = comparison)) +
geom_jitter(size = 0.5, alpha = 0.01) +
geom_boxplot(aes(comparison, value), outlier.shape = NA, color = "black",
fill = NA, inherit.aes = F) +
geom_text(data = label.df, aes(x = comparison, y = Value, label = Sig, group = NULL),
inherit.aes = F) +
scale_colour_manual(values = brewer.pal(6, "Paired")[3:4]) +
labs(x = "Environment comparison",
y = "Bray-Curtis dissimilarity") +
ylim(0,1.05) +
theme_bw() +
theme(plot.margin = unit(c(0.1,0.1,0.1,0.1),"cm"),
legend.position = "none",
axis.title.y = element_blank(),
axis.text.y = element_blank())
p_bac <- insert_yaxis_grob(p3, p4, position = "right")
g2 <- ggdraw(p_bac)
png("FigsUpdated/CompareBrayCurtis_wDensity.png", width = 9, height = 3, units = "in", res = 300)
plot_grid(g1, g2, g3,
ncol = 3,
labels = c("a) Archaea", "b) Bacteria", "c) Fungi"),
rel_widths = c(0.4, 0.3, 0.3))
dev.off()
ggplot(data = combined, aes(comparison, value)) +
geom_jitter(size = 0.5, alpha = 0.01, aes(colour = taxcomp)) +
geom_violin(outlier.shape = NA, color = "black", fill = NA) +
geom_text(data = label.df, aes(x = comparison, y = Value, label = Sig, group = NULL),
inherit.aes = F) +
scale_colour_manual(values = brewer.pal(6, "Paired")[1:6]) +
labs(x = "Environment comparison",
y = "Bray-Curtis dissimilarity") +
facet_wrap(~ taxon, ncol = 3) +
ylim(0,1.05) +
theme_bw() +
theme(plot.margin = unit(c(0.1,0.1,0.1,0.1),"cm"),
legend.position = "none")
ggplot(data = combined, aes(comparison, value)) +
#geom_jitter(size = 0.5, alpha = 0.01, aes(colour = taxcomp)) +
geom_violin(color = "black", fill = NA) +
geom_boxplot(width = 0.1, outlier.shape = NA) +
stat_summary(fun.y=mean, geom="point", shape=23, size=2)
ggplot(data = combined, aes(comparison, value)) +
#geom_jitter(size = 0.5, alpha = 0.01, aes(colour = taxcomp)) +
geom_violin(color = "black", fill = NA) +
geom_boxplot(width = 0.1, outlier.shape = NA) +
stat_summary(fun.y = mean, geom = "point", shape = 23, size = 2) +
geom_text(data = label.df, aes(x = comparison, y = Value, label = Sig, group = NULL),
inherit.aes = F) +
scale_colour_manual(values = brewer.pal(6, "Paired")[1:6]) +
labs(x = "Environment comparison",
y = "Bray-Curtis dissimilarity") +
facet_wrap(~ taxon, ncol = 3) +
ylim(0,1.05) +
theme_bw() +
theme(plot.margin = unit(c(0.1,0.1,0.1,0.1),"cm"),
legend.position = "none")
ggplot(data = combined, aes(comparison, value, colour = taxacomp)) +
#geom_jitter(size = 0.5, alpha = 0.01, aes(colour = taxcomp)) +
geom_violin(color = "black", fill = NA) +
geom_boxplot(width = 0.1, outlier.shape = NA) +
stat_summary(fun.y = mean, geom = "point", shape = 23, size = 2) +
geom_text(data = label.df, aes(x = comparison, y = Value, label = Sig, group = NULL),
inherit.aes = F) +
scale_colour_manual(values = brewer.pal(6, "Paired")[1:6]) +
labs(x = "Environment comparison",
y = "Bray-Curtis dissimilarity") +
facet_wrap(~ taxon, ncol = 3) +
ylim(0,1.05) +
theme_bw() +
theme(plot.margin = unit(c(0.1,0.1,0.1,0.1),"cm"),
legend.position = "none")
ggplot(data = combined, aes(comparison, value, colour = taxcomp)) +
#geom_jitter(size = 0.5, alpha = 0.01, aes(colour = taxcomp)) +
geom_violin(color = "black", fill = NA) +
geom_boxplot(width = 0.1, outlier.shape = NA) +
stat_summary(fun.y = mean, geom = "point", shape = 23, size = 2) +
geom_text(data = label.df, aes(x = comparison, y = Value, label = Sig, group = NULL),
inherit.aes = F) +
scale_colour_manual(values = brewer.pal(6, "Paired")[1:6]) +
labs(x = "Environment comparison",
y = "Bray-Curtis dissimilarity") +
facet_wrap(~ taxon, ncol = 3) +
ylim(0,1.05) +
theme_bw() +
theme(plot.margin = unit(c(0.1,0.1,0.1,0.1),"cm"),
legend.position = "none")
ggplot(data = combined, aes(comparison, value, colour = taxcomp)) +
#geom_jitter(size = 0.5, alpha = 0.01, aes(colour = taxcomp)) + # don't show, too many
geom_violin() +
geom_boxplot(width = 0.1, outlier.shape = NA) +
stat_summary(fun.y = mean, geom = "point", shape = 23, size = 2) +
geom_text(data = label.df, aes(x = comparison, y = Value, label = Sig, group = NULL),
inherit.aes = F) +
scale_colour_manual(values = brewer.pal(6, "Paired")[1:6]) +
labs(x = "Environment comparison",
y = "Bray-Curtis dissimilarity") +
facet_wrap(~ taxon, ncol = 3) +
ylim(0,1.05) +
theme_bw() +
theme(plot.margin = unit(c(0.1,0.1,0.1,0.1),"cm"),
legend.position = "none")
m <- aov(value ~ taxcomp, data = combined)
summary(m)
TukeyHSD(m)
leveneTest(value ~ taxcomp, data = combined)
kruskal.test(value ~ taxcomp, data = combined)
shapiro.test(m$residuals)
shapiro.test(m$residuals[1:5000])
suppressWarnings(suppressMessages(library(PMCMRplus))) # For Nemenyi posthoc
kwAllPairsNemenyiTest(value ~ taxcomp, data = combined)
kwAllPairsNemenyiTest(value, taxcomp, data = combined)
kwAllPairsNemenyiTest(combined$value, combined$taxcomp)
kwAllPairsNemenyiTest(combined$value, as.factor(combined$taxcomp))
# Basic barplot
label.df <- data.frame(taxon = c("Fungi", "Fungi",
"Bacteria", "Bacteria",
"Archaea", "Archaea"),
comparison = c("between","within",
"between","within",
"between","within"),
Value = c(1.05,1.05,1.05,1.05,1.05,1.05),
Sig = c("a","b","c","d","e","f"))
ggplot(data = combined, aes(comparison, value, colour = taxcomp)) +
#geom_jitter(size = 0.5, alpha = 0.01, aes(colour = taxcomp)) + # don't show, too many
geom_violin() +
geom_boxplot(width = 0.1, outlier.shape = NA) +
stat_summary(fun.y = mean, geom = "point", shape = 23, size = 2) +
geom_text(data = label.df, aes(x = comparison, y = Value, label = Sig, group = NULL),
inherit.aes = F) +
scale_colour_manual(values = brewer.pal(6, "Paired")[1:6]) +
labs(x = "Environment comparison",
y = "Bray-Curtis dissimilarity") +
facet_wrap(~ taxon, ncol = 3) +
ylim(0,1.05) +
theme_bw() +
theme(plot.margin = unit(c(0.1,0.1,0.1,0.1),"cm"),
legend.position = "none")
# Basic barplot
label.df <- data.frame(taxon = c("Fungi", "Fungi",
"Bacteria", "Bacteria",
"Archaea", "Archaea"),
comparison = c("between","within",
"between","within",
"between","within"),
Value = c(1.05,1.05,1.05,1.05,1.05,1.05),
Sig = c("e","f","c","d","a","b"))
ggplot(data = combined, aes(comparison, value, colour = taxcomp)) +
#geom_jitter(size = 0.5, alpha = 0.01, aes(colour = taxcomp)) + # don't show, too many
geom_violin() +
geom_boxplot(width = 0.1, outlier.shape = NA) +
stat_summary(fun.y = mean, geom = "point", shape = 23, size = 2) +
geom_text(data = label.df, aes(x = comparison, y = Value, label = Sig, group = NULL),
inherit.aes = F) +
scale_colour_manual(values = brewer.pal(6, "Paired")[1:6]) +
labs(x = "Environment comparison",
y = "Bray-Curtis dissimilarity") +
facet_wrap(~ taxon, ncol = 3) +
ylim(0,1.05) +
theme_bw() +
theme(plot.margin = unit(c(0.1,0.1,0.1,0.1),"cm"),
legend.position = "none")
install.packages("DirichletReg")
suppressWarnings(suppressMessages(library(DirichletReg))) # For analyzing proportions
m <- DirichReg(value ~ taxcomp, data = combined, model = "common", verbosity = 4)
dr <- DR_data(combined)
# Best option is probably violin plot!
png("FigsUpdated/CompareBrayCurtis_genus.png", width = 7, height = 3, units = "in", res = 300)
ggplot(data = combined, aes(comparison, value, colour = taxcomp)) +
#geom_jitter(size = 0.5, alpha = 0.01, aes(colour = taxcomp)) + # don't show, too many
geom_violin() +
geom_boxplot(width = 0.1, outlier.shape = NA) +
stat_summary(fun.y = mean, geom = "point", shape = 23, size = 2) +
geom_text(data = label.df, aes(x = comparison, y = Value, label = Sig, group = NULL),
inherit.aes = F) +
scale_colour_manual(values = brewer.pal(6, "Paired")[1:6]) +
labs(x = "Environment comparison",
y = "Bray-Curtis dissimilarity") +
facet_wrap(~ taxon, ncol = 3) +
ylim(0,1.05) +
theme_bw() +
theme(plot.margin = unit(c(0.1,0.1,0.1,0.1),"cm"),
legend.position = "none")
dev.off()
View(input_fungi_CPM_nz$data_loaded)
View(tax_sum_phyla)
variable = "Environment"
column1 <- paste(variable, "x", sep = ".")
column1
source("compareBC.R")
source("compareBC.R")
source("compareBC.R")
#### __Family ####
# Wrote function to streamline this some
arc_bray_df_long <- compareBC(input = input_arc_CPM_nz,
sampleID = "sampleID",
variable = "Environment",
level = 3)
View(env)
source("compareBC.R")
bac_bray_df_long <- compareBC(input = input_bac_CPM_nz,
sampleID = "sampleID",
variable = "Environment",
level = 3)
bac_bray_df_long <- compareBC(input = input_bac_CPM,
sampleID = "sampleID",
variable = "Environment",
level = 3)
fun_bray_df_long <- compareBC(input = input_fun_CPM_nz,
sampleID = "sampleID",
variable = "Environment",
level = 3)
fun_bray_df_long <- compareBC(input = input_fungi_CPM_nz,
sampleID = "sampleID",
variable = "Environment",
level = 3)
# Combine and Graph
fun_bray_df_long$taxon <- "Fungi"
bac_bray_df_long$taxon <- "Bacteria"
arc_bray_df_long$taxon <- "Archaea"
source("compareBC.R")
#### __Family ####
# Wrote function to streamline this some
arc_bray_df_long <- compareBC(input = input_arc_CPM_nz,
sampleID = "sampleID",
variable = "Environment",
level = 3)
View(arc_bray_df_long)
bac_bray_df_long <- compareBC(input = input_bac_CPM,
sampleID = "sampleID",
variable = "Environment",
level = 3)
fun_bray_df_long <- compareBC(input = input_fungi_CPM_nz,
sampleID = "sampleID",
variable = "Environment",
level = 3)
# Combine and Graph
fun_bray_df_long$taxon <- "Fungi"
bac_bray_df_long$taxon <- "Bacteria"
arc_bray_df_long$taxon <- "Archaea"
combined <- rbind(fun_bray_df_long, bac_bray_df_long, arc_bray_df_long)
combined$taxcomp <- paste(combined$taxon, combined$comparison, sep = "_")
leveneTest(value ~ taxcomp, data = combined)
m <- aov(value ~ taxcomp, data = combined)
summary(m)
TukeyHSD(m)
shapiro.test(m$residuals[1:5000])
kruskal.test(value ~ taxcomp, data = combined)
kwAllPairsNemenyiTest(combined$value, as.factor(combined$taxcomp))
ggplot(data = combined, aes(comparison, value, colour = taxcomp)) +
geom_violin() +
geom_boxplot(width = 0.1, outlier.shape = NA) +
stat_summary(fun.y = mean, geom = "point", shape = 23, size = 2) +
geom_text(data = label.df, aes(x = comparison, y = Value, label = Sig, group = NULL),
inherit.aes = F) +
scale_colour_manual(values = brewer.pal(6, "Paired")[1:6]) +
labs(x = "Environment comparison",
y = "Bray-Curtis dissimilarity") +
facet_wrap(~ taxon, ncol = 3) +
ylim(0,1.05) +
theme_bw() +
theme(plot.margin = unit(c(0.1,0.1,0.1,0.1),"cm"),
legend.position = "none")
png("FigsUpdated/CompareBrayCurtis_family.png", width = 7, height = 3, units = "in", res = 300)
ggplot(data = combined, aes(comparison, value, colour = taxcomp)) +
geom_violin() +
geom_boxplot(width = 0.1, outlier.shape = NA) +
stat_summary(fun.y = mean, geom = "point", shape = 23, size = 2) +
geom_text(data = label.df, aes(x = comparison, y = Value, label = Sig, group = NULL),
inherit.aes = F) +
scale_colour_manual(values = brewer.pal(6, "Paired")[1:6]) +
labs(x = "Environment comparison",
y = "Bray-Curtis dissimilarity") +
facet_wrap(~ taxon, ncol = 3) +
ylim(0,1.05) +
theme_bw() +
theme(plot.margin = unit(c(0.1,0.1,0.1,0.1),"cm"),
legend.position = "none")
dev.off()
#### __Order ####
# Wrote function to streamline this some
arc_bray_df_long <- compareBC(input = input_arc_CPM_nz,
sampleID = "sampleID",
variable = "Environment",
level = 4)
bac_bray_df_long <- compareBC(input = input_bac_CPM,
sampleID = "sampleID",
variable = "Environment",
level = 4)
fun_bray_df_long <- compareBC(input = input_fungi_CPM_nz,
sampleID = "sampleID",
variable = "Environment",
level = 4)
# Combine and Graph
fun_bray_df_long$taxon <- "Fungi"
bac_bray_df_long$taxon <- "Bacteria"
arc_bray_df_long$taxon <- "Archaea"
combined <- rbind(fun_bray_df_long, bac_bray_df_long, arc_bray_df_long)
combined$taxcomp <- paste(combined$taxon, combined$comparison, sep = "_")
leveneTest(value ~ taxcomp, data = combined)
m <- aov(value ~ taxcomp, data = combined)
summary(m)
TukeyHSD(m)
shapiro.test(m$residuals[1:5000])
kruskal.test(value ~ taxcomp, data = combined)
kwAllPairsNemenyiTest(combined$value, as.factor(combined$taxcomp))
ggplot(data = combined, aes(comparison, value, colour = taxcomp)) +
geom_violin() +
geom_boxplot(width = 0.1, outlier.shape = NA) +
stat_summary(fun.y = mean, geom = "point", shape = 23, size = 2) +
geom_text(data = label.df, aes(x = comparison, y = Value, label = Sig, group = NULL),
inherit.aes = F) +
scale_colour_manual(values = brewer.pal(6, "Paired")[1:6]) +
labs(x = "Environment comparison",
y = "Bray-Curtis dissimilarity") +
facet_wrap(~ taxon, ncol = 3) +
ylim(0,1.05) +
theme_bw() +
theme(plot.margin = unit(c(0.1,0.1,0.1,0.1),"cm"),
legend.position = "none")
png("FigsUpdated/CompareBrayCurtis_order.png", width = 7, height = 3, units = "in", res = 300)
ggplot(data = combined, aes(comparison, value, colour = taxcomp)) +
geom_violin() +
geom_boxplot(width = 0.1, outlier.shape = NA) +
stat_summary(fun.y = mean, geom = "point", shape = 23, size = 2) +
geom_text(data = label.df, aes(x = comparison, y = Value, label = Sig, group = NULL),
inherit.aes = F) +
scale_colour_manual(values = brewer.pal(6, "Paired")[1:6]) +
labs(x = "Environment comparison",
y = "Bray-Curtis dissimilarity") +
facet_wrap(~ taxon, ncol = 3) +
ylim(0,1.05) +
theme_bw() +
theme(plot.margin = unit(c(0.1,0.1,0.1,0.1),"cm"),
legend.position = "none")
dev.off()
arc_bray_df_long <- compareBC(input = input_arc_CPM_nz,
sampleID = "sampleID",
variable = "Environment",
level = 5)
bac_bray_df_long <- compareBC(input = input_bac_CPM,
sampleID = "sampleID",
variable = "Environment",
level = 5)
fun_bray_df_long <- compareBC(input = input_fungi_CPM_nz,
sampleID = "sampleID",
variable = "Environment",
level = 5)
# Combine and Graph
fun_bray_df_long$taxon <- "Fungi"
bac_bray_df_long$taxon <- "Bacteria"
arc_bray_df_long$taxon <- "Archaea"
combined <- rbind(fun_bray_df_long, bac_bray_df_long, arc_bray_df_long)
combined$taxcomp <- paste(combined$taxon, combined$comparison, sep = "_")
leveneTest(value ~ taxcomp, data = combined)
m <- aov(value ~ taxcomp, data = combined)
summary(m)
TukeyHSD(m)
shapiro.test(m$residuals[1:5000])
kruskal.test(value ~ taxcomp, data = combined)
kwAllPairsNemenyiTest(combined$value, as.factor(combined$taxcomp))
png("FigsUpdated/CompareBrayCurtis_family.png", width = 7, height = 3, units = "in", res = 300)
ggplot(data = combined, aes(comparison, value, colour = taxcomp)) +
geom_violin() +
geom_boxplot(width = 0.1, outlier.shape = NA) +
stat_summary(fun.y = mean, geom = "point", shape = 23, size = 2) +
geom_text(data = label.df, aes(x = comparison, y = Value, label = Sig, group = NULL),
inherit.aes = F) +
scale_colour_manual(values = brewer.pal(6, "Paired")[1:6]) +
labs(x = "Environment comparison",
y = "Bray-Curtis dissimilarity") +
facet_wrap(~ taxon, ncol = 3) +
ylim(0,1.05) +
theme_bw() +
theme(plot.margin = unit(c(0.1,0.1,0.1,0.1),"cm"),
legend.position = "none")
dev.off()
arc_bray_df_long <- compareBC(input = input_arc_CPM_nz,
sampleID = "sampleID",
variable = "Environment",
level = 2)
bac_bray_df_long <- compareBC(input = input_bac_CPM,
sampleID = "sampleID",
variable = "Environment",
level = 2)
fun_bray_df_long <- compareBC(input = input_fungi_CPM_nz,
sampleID = "sampleID",
variable = "Environment",
level = 2)
# Combine and Graph
fun_bray_df_long$taxon <- "Fungi"
bac_bray_df_long$taxon <- "Bacteria"
arc_bray_df_long$taxon <- "Archaea"
combined <- rbind(fun_bray_df_long, bac_bray_df_long, arc_bray_df_long)
combined$taxcomp <- paste(combined$taxon, combined$comparison, sep = "_")
leveneTest(value ~ taxcomp, data = combined)
m <- aov(value ~ taxcomp, data = combined)
summary(m)
TukeyHSD(m)
shapiro.test(m$residuals[1:5000])
kruskal.test(value ~ taxcomp, data = combined)
kwAllPairsNemenyiTest(combined$value, as.factor(combined$taxcomp))
png("FigsUpdated/CompareBrayCurtis_phylum.png", width = 7, height = 3, units = "in", res = 300)
ggplot(data = combined, aes(comparison, value, colour = taxcomp)) +
geom_violin() +
geom_boxplot(width = 0.1, outlier.shape = NA) +
stat_summary(fun.y = mean, geom = "point", shape = 23, size = 2) +
geom_text(data = label.df, aes(x = comparison, y = Value, label = Sig, group = NULL),
inherit.aes = F) +
scale_colour_manual(values = brewer.pal(6, "Paired")[1:6]) +
labs(x = "Environment comparison",
y = "Bray-Curtis dissimilarity") +
facet_wrap(~ taxon, ncol = 3) +
ylim(0,1.05) +
theme_bw() +
theme(plot.margin = unit(c(0.1,0.1,0.1,0.1),"cm"),
legend.position = "none")
dev.off()
label.df <- data.frame(taxon = c("Fungi", "Fungi",
"Bacteria", "Bacteria",
"Archaea", "Archaea"),
comparison = c("between","within",
"between","within",
"between","within"),
Value = c(1.05,1.05,1.05,1.05,1.05,1.05),
Sig = c("c","f","c","d","a","b"))
png("FigsUpdated/CompareBrayCurtis_phylum.png", width = 7, height = 3, units = "in", res = 300)
ggplot(data = combined, aes(comparison, value, colour = taxcomp)) +
geom_violin() +
geom_boxplot(width = 0.1, outlier.shape = NA) +
stat_summary(fun.y = mean, geom = "point", shape = 23, size = 2) +
geom_text(data = label.df, aes(x = comparison, y = Value, label = Sig, group = NULL),
inherit.aes = F) +
scale_colour_manual(values = brewer.pal(6, "Paired")[1:6]) +
labs(x = "Environment comparison",
y = "Bray-Curtis dissimilarity") +
facet_wrap(~ taxon, ncol = 3) +
ylim(0,1.05) +
theme_bw() +
theme(plot.margin = unit(c(0.1,0.1,0.1,0.1),"cm"),
legend.position = "none")
dev.off()
