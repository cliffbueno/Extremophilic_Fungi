scale_size(range = c(1, 10)) +
labs(x = paste("PC1: ", pcoaA1, "%", sep = ""),
y = paste("PC2: ", pcoaA2, "%", sep = ""),
colour = "Environment",
size = "Number of KOs",
title = "KO Bray-Curtis") +
xlim(-0.2, 0.28) +
ylim(-0.3, 0.12) +
guides(colour = guide_legend(override.aes = list(alpha = 1, size = 3))) +
theme_bw() +
theme(legend.position = "right",
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
plot.title = element_text(vjust = 0),
panel.grid = element_blank())
g5_ko
ko_pcoa_leg <- get_legend(g5_ko)
g5_ko <- g5_ko +
theme(legend.position = "none")
jac_ko <- vegdist(ko_comm_DESeq_filt, method = "jaccard")
pcoa1_ko <- cmdscale(jac_ko, k = nrow(ko_meta_filt) - 1, eig = T)
pcoa1A1 <- round((eigenvals(pcoa1_ko)/sum(eigenvals(pcoa1_ko)))[1]*100, digits = 1)
pcoa1A2 <- round((eigenvals(pcoa1_ko)/sum(eigenvals(pcoa1_ko)))[2]*100, digits = 1)
pcoa1A1
pcoa1A2
ko_meta_filt$Axis01j <- scores(pcoa1_ko)[,1]
ko_meta_filt$Axis02j <- scores(pcoa1_ko)[,2]
range(ko_meta_filt$Axis01j)
range(ko_meta_filt$Axis02j)
micro.hullsj <- ddply(ko_meta_filt, c("Environment"), find_hullj)
g6_ko <- ggplot(ko_meta_filt, aes(Axis01j, Axis02j, colour = Environment)) +
geom_polygon(data = micro.hullsj, aes(colour = Environment, fill = Environment),
alpha = 0.1, show.legend = F) +
geom_point(aes(size = richness_KO), alpha = 0.5) +
scale_size(range = c(1, 10)) +
labs(x = paste("PC1: ", pcoaA1, "%", sep = ""),
y = paste("PC2: ", pcoaA2, "%", sep = ""),
colour = "Environment",
size = "Number of KOs",
title = "KO Jaccard") +
xlim(-0.2, 0.28) +
ylim(-0.3, 0.12) +
guides(colour = guide_legend(override.aes = list(alpha = 1, size = 3))) +
theme_bw() +
theme(legend.position = "none",
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
plot.title = element_text(vjust = 0),
panel.grid = element_blank())
g6_ko
pcoaA1
g6_ko <- ggplot(ko_meta_filt, aes(Axis01j, Axis02j, colour = Environment)) +
geom_polygon(data = micro.hullsj, aes(colour = Environment, fill = Environment),
alpha = 0.1, show.legend = F) +
geom_point(aes(size = richness_KO), alpha = 0.5) +
scale_size(range = c(1, 10)) +
labs(x = paste("PC1: ", pcoa1A1, "%", sep = ""),
y = paste("PC2: ", pcoa1A2, "%", sep = ""),
colour = "Environment",
size = "Number of KOs",
title = "KO Jaccard") +
xlim(-0.2, 0.28) +
ylim(-0.3, 0.12) +
guides(colour = guide_legend(override.aes = list(alpha = 1, size = 3))) +
theme_bw() +
theme(legend.position = "none",
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
plot.title = element_text(vjust = 0),
panel.grid = element_blank())
g6_ko
plot_grid(g5_ko, g6_ko, ko_pcoa_leg, ncol = 3, rel_widths = c(2.5,2.5,1.1))
g6_ko <- ggplot(ko_meta_filt, aes(Axis01j, Axis02j, colour = Environment)) +
geom_polygon(data = micro.hullsj, aes(colour = Environment, fill = Environment),
alpha = 0.1, show.legend = F) +
geom_point(aes(size = richness_KO), alpha = 0.5) +
scale_size(range = c(1, 10)) +
labs(x = paste("PC1: ", pcoa1A1, "%", sep = ""),
y = paste("PC2: ", pcoa1A2, "%", sep = ""),
colour = "Environment",
size = "Number of KOs",
title = "KO Jaccard") +
xlim(-0.2, 0.29) +
ylim(-0.3, 0.12) +
guides(colour = guide_legend(override.aes = list(alpha = 1, size = 3))) +
theme_bw() +
theme(legend.position = "none",
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
plot.title = element_text(vjust = 0),
panel.grid = element_blank())
g6_ko
g5_ko <- ggplot(ko_meta_filt, aes(Axis01, Axis02, colour = Environment)) +
geom_polygon(data = micro.hulls, aes(colour = Environment, fill = Environment),
alpha = 0.1, show.legend = F) +
geom_point(aes(size = richness_KO), alpha = 0.5) +
scale_size(range = c(1, 10)) +
labs(x = paste("PC1: ", pcoaA1, "%", sep = ""),
y = paste("PC2: ", pcoaA2, "%", sep = ""),
colour = "Environment",
size = "Number of KOs",
title = "KO Bray-Curtis") +
xlim(-0.2, 0.29) +
ylim(-0.3, 0.12) +
guides(colour = guide_legend(override.aes = list(alpha = 1, size = 3))) +
theme_bw() +
theme(legend.position = "right",
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
plot.title = element_text(vjust = 0),
panel.grid = element_blank())
g5_ko
g6_ko <- ggplot(ko_meta_filt, aes(Axis01j, Axis02j, colour = Environment)) +
geom_polygon(data = micro.hullsj, aes(colour = Environment, fill = Environment),
alpha = 0.1, show.legend = F) +
geom_point(aes(size = richness_KO), alpha = 0.5) +
scale_size(range = c(1, 10)) +
labs(x = paste("PC1: ", pcoa1A1, "%", sep = ""),
y = paste("PC2: ", pcoa1A2, "%", sep = ""),
colour = "Environment",
size = "Number of KOs",
title = "KO Jaccard") +
xlim(-0.2, 0.29) +
ylim(-0.3, 0.12) +
guides(colour = guide_legend(override.aes = list(alpha = 1, size = 3))) +
theme_bw() +
theme(legend.position = "none",
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
plot.title = element_text(vjust = 0),
panel.grid = element_blank())
g6_ko
plot_grid(g5_ko, g6_ko, ko_pcoa_leg, ncol = 3, rel_widths = c(2.5,2.5,1.1))
ko_pcoa_leg <- get_legend(g5_ko)
g5_ko <- g5_ko +
theme(legend.position = "none")
plot_grid(g5_ko, g6_ko, ko_pcoa_leg, ncol = 3, rel_widths = c(2.5,2.5,1.1))
hue_pal()(9)
g6_ko <- ggplot(ko_meta_filt, aes(Axis01j, Axis02j, colour = Environment)) +
geom_polygon(data = micro.hullsj, aes(colour = Environment, fill = Environment),
alpha = 0.1, show.legend = F) +
geom_point(aes(size = richness_KO), alpha = 0.5) +
scale_size(range = c(1, 10)) +
labs(x = paste("PC1: ", pcoa1A1, "%", sep = ""),
y = paste("PC2: ", pcoa1A2, "%", sep = ""),
colour = "Environment",
size = "Number of KOs",
title = "KO Jaccard") +
scale_clour_manual(values = c(hue_pal()(9)[1:5], hue_pal()(9)[7:9])) +
xlim(-0.2, 0.29) +
ylim(-0.3, 0.12) +
guides(colour = guide_legend(override.aes = list(alpha = 1, size = 3))) +
theme_bw() +
theme(legend.position = "none",
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
plot.title = element_text(vjust = 0),
panel.grid = element_blank())
g6_ko <- ggplot(ko_meta_filt, aes(Axis01j, Axis02j, colour = Environment)) +
geom_polygon(data = micro.hullsj, aes(colour = Environment, fill = Environment),
alpha = 0.1, show.legend = F) +
geom_point(aes(size = richness_KO), alpha = 0.5) +
scale_size(range = c(1, 10)) +
labs(x = paste("PC1: ", pcoa1A1, "%", sep = ""),
y = paste("PC2: ", pcoa1A2, "%", sep = ""),
colour = "Environment",
size = "Number of KOs",
title = "KO Jaccard") +
scale_colour_manual(values = c(hue_pal()(9)[1:5], hue_pal()(9)[7:9])) +
xlim(-0.2, 0.29) +
ylim(-0.3, 0.12) +
guides(colour = guide_legend(override.aes = list(alpha = 1, size = 3))) +
theme_bw() +
theme(legend.position = "none",
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
plot.title = element_text(vjust = 0),
panel.grid = element_blank())
g6_ko
g5_ko <- ggplot(ko_meta_filt, aes(Axis01, Axis02, colour = Environment)) +
geom_polygon(data = micro.hulls, aes(colour = Environment, fill = Environment),
alpha = 0.1, show.legend = F) +
geom_point(aes(size = richness_KO), alpha = 0.5) +
scale_size(range = c(1, 10)) +
labs(x = paste("PC1: ", pcoaA1, "%", sep = ""),
y = paste("PC2: ", pcoaA2, "%", sep = ""),
colour = "Environment",
size = "Number of KOs",
title = "KO Bray-Curtis") +
scale_colour_manual(values = c(hue_pal()(9)[1:5], hue_pal()(9)[7:9])) +
xlim(-0.2, 0.29) +
ylim(-0.3, 0.12) +
guides(colour = guide_legend(override.aes = list(alpha = 1, size = 3))) +
theme_bw() +
theme(legend.position = "right",
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
plot.title = element_text(vjust = 0),
panel.grid = element_blank())
g5_ko
ko_pcoa_leg <- get_legend(g5_ko)
g5_ko <- g5_ko +
theme(legend.position = "none")
plot_grid(g5_ko, g6_ko, ko_pcoa_leg, ncol = 3, rel_widths = c(2.5,2.5,1.1))
pdf("FigsUpdated/KO_PCoA_min750KOs.pdf", width = 8.5, height = 5)
plot_grid(g5_ko, g6_ko, ko_pcoa_leg, ncol = 3, rel_widths = c(2.5,2.5,1.1))
dev.off()
plot_grid(g5_ko, g6_ko, ko_pcoa_leg, ncol = 3, rel_widths = c(2.5,2.5,1.1),
labels = "AUTO")
plot_grid(g5_ko, g6_ko, ko_pcoa_leg, ncol = 3, rel_widths = c(2.5,2.5,1.1),
labels = c("A", "B"))
pdf("FigsUpdated/KO_PCoA_min750KOs.pdf", width = 8.5, height = 5)
plot_grid(g5_ko, g6_ko, ko_pcoa_leg, ncol = 3, rel_widths = c(2.5,2.5,1.1),
labels = c("A", "B"))
dev.off()
png("FinalFigs/Figure5.png", width = 8.5, height = 5, units = "in", res = 300)
plot_grid(g5_ko, g6_ko, ko_pcoa_leg, ncol = 3, rel_widths = c(2.5,2.5,1.1),
labels = c("A", "B"))
dev.off()
#### __Stats ####
# Rerun whichever richness filter you want, then run this
bc_ko <- vegdist(ko_comm_DESeq_filt, method = "bray")
jac_ko <- vegdist(ko_comm_DESeq_filt, method = "jaccard")
set.seed(308)
adonis2(bc_ko ~ Environment, data = ko_meta_filt) # R2 = 0.25, p = 0.001
anova(betadisper(bc_ko, ko_meta_filt$Environment)) # Dispersion not homogeneous
set.seed(308)
adonis2(jac_ko ~ ko_meta_filt$Environment) # R2 = 0.23, p = 0.001
#stress_genes <- stress_genes %>%
#  dplyr::select(-Symbol, -Name, -Protein) %>%
#  separate(Definition, into = c("Symbol", "Name"), sep = ";", remove = F) %>%
#  dplyr::select(KO, Definition, Symbol, Name, Stress, Notes)
#write.csv(stress_genes, file = "stress_genes_wDef.csv", row.names = F)
stress_genes <- read.csv("stress_genes_wDef.csv") %>%
filter(KO %in% colnames(ko_comm_DESeq)) %>%
filter(!duplicated(KO))
# Data frame
gene_plot <- ko_comm_DESeq %>%
dplyr::select(stress_genes$KO) %>%
mutate("Environment" = ko_meta$Environment)
#### __ (I) Stats ####
# Run a loop
kruskal_results_genes <- as.data.frame(matrix(data = NA, ncol(gene_plot)-1, 3)) %>%
set_names(c("Gene", "X2", "P"))
for (i in 1:(ncol(gene_plot)-1)) {
k <- kruskal.test(gene_plot[[i]] ~ gene_plot$Environment)
kruskal_results_genes$Gene[i] <- names(gene_plot)[i]
kruskal_results_genes$X2[i] <- round(k$statistic, digits = 2)
kruskal_results_genes$P[i] <- k$p.value
}
kruskal_results_genes <- kruskal_results_genes %>%
filter(is.na(Gene) == F) %>%
mutate(Pfdr = p.adjust(P, method = "fdr"))
#### __ (II) Graphs ####
# Barplot
table(ko_meta$Environment)
gene_plot_long <- gene_plot %>%
pivot_longer(names(gene_plot)[1:157],
names_to = "Gene", values_to = "Abundance") %>%
mutate(Gene = as.factor(Gene)) %>%
droplevels() %>%
mutate(Environment = dplyr::recode_factor(Environment,
"Acid mine drainage" = "Acid mine drainage (n = 33)",
"Cryosphere" = "Cryosphere (n = 47)",
"Desert" = "Desert (n = 33)",
"Glacial forefield" = "Glacial forefield (n = 60)",
"Hot spring" = "Hot spring (n = 167)",
"Hydrothermal vent" = "Hydrothermal vent (n = 237)",
"Hypersaline" = "Hypersaline (n = 225)",
"Soda lake" = "Soda lake (n = 25)"))
gene_plot_summary <- gene_plot_long %>%
group_by(Environment, Gene) %>%
summarise(mean = mean(Abundance),
se = std.error(Abundance))
# Too many to do barplot
ggplot(gene_plot_summary, aes(Environment, mean, fill = Gene, group = Gene)) +
geom_bar(stat = "identity", position = position_dodge(0.75)) +
geom_linerange(aes(x = Environment, ymin = mean - se, ymax = mean + se,
group = Gene),
position = position_dodge(0.75)) +
labs(x = NULL,
y = "Abundance (DESeq2 normalized)",
fill = "KO") +
#scale_fill_manual(values = brewer.pal(10, "Paired"),
#                  labels = ko_list$KO_def[1:10]) +
scale_y_continuous(expand = c(0.01, 0.01)) +
theme_classic() +
theme(axis.title = element_text(size = 12),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10, angle = 45, hjust = 1, vjust = 1),
legend.text = element_text(size = 8),
legend.key.size = unit(0.5, "cm"),
legend.position = "right",
plot.margin = unit(c(0.1, 0.1, 0.1, 0.7), "cm"))
# Heatmap
# Use pheatmap (pretty heatmap) package
# Sort by environment
ko_meta_sorted <- ko_meta %>%
arrange(Environment)
reorder_idx <- match(rownames(ko_meta_sorted), rownames(ko_comm_DESeq))
ko_comm_DESeq_sorted <- ko_comm_DESeq[reorder_idx,]
sum(rownames(ko_meta_sorted) != rownames(ko_comm_DESeq_sorted))
# Sort by stress
stress_genes_sorted <- stress_genes %>%
arrange(Stress)
#write.csv(stress_genes_sorted, "stress_genes_sorted_5.19.23.csv")
stress_genes_sorted$KOsymb <- paste(stress_genes_sorted$KO, stress_genes_sorted$Symbol, sep = "; ")
gene_hm <- ko_comm_DESeq_sorted %>%
dplyr::select(stress_genes_sorted$KO) %>%
mutate("sampleID" = ko_meta_sorted$sampleID)
rownames(gene_hm) <- gene_hm$sampleID
gene_hm <- gene_hm %>%
dplyr::select(-sampleID) %>%
t() %>%
as.matrix()
ann_cols <- data.frame(row.names = colnames(gene_hm),
Environment = ko_meta_sorted$Environment)
ann_rows <- data.frame(row.names = rownames(gene_hm),
Stress = stress_genes_sorted$Stress)
ann_colors <- list(Environment = c("Acid mine drainage" = hue_pal()(9)[1],
"Cryosphere - soil" = hue_pal()(9)[2],
"Cryosphere - water" = hue_pal()(9)[3],
"Desert" = hue_pal()(9)[4],
"Glacial forefield" = hue_pal()(9)[5],
"Hot spring" = hue_pal()(9)[6],
"Hydrothermal vent" = hue_pal()(9)[7],
"Hypersaline" = hue_pal()(9)[8],
"Soda lake" = hue_pal()(9)[9]),
Stress = c("Alkaline pH" = viridis_pal()(17)[1],
"Cellular" = viridis_pal()(17)[2],
"Chlorine" = viridis_pal()(17)[3],
"Cold" = viridis_pal()(17)[4],
"Environmental" = viridis_pal()(17)[5],
"Environmental-Oxidative" = viridis_pal()(17)[6],
"General" = viridis_pal()(17)[7],
"Granule" = viridis_pal()(17)[8],
"Heat" = viridis_pal()(17)[9],
"Heat-Osmotic" = viridis_pal()(17)[10],
"High pH" = viridis_pal()(17)[11],
"Metal resistance-Zn" = viridis_pal()(17)[12],
"Osmotic" = viridis_pal()(17)[13],
"Osmotic, Low pH" = viridis_pal()(17)[14],
"Oxidative" = viridis_pal()(17)[15],
"pH" = viridis_pal()(17)[16],
"Starvation" = viridis_pal()(17)[17]))
phm1 <- pheatmap(gene_hm,
color = colorRampPalette(rev(brewer.pal(n = 7, name = "RdBu")))(100),
border_color = NA,
scale = "row",
show_colnames = F,
angle_col = 315,
cluster_rows = F,
cluster_cols = F,
fontsize_row = 4,
annotation_col = ann_cols,
annotation_row = ann_rows,
annotation_colors = ann_colors)
# Still no good. Summarize by environment so there are only 9 columns
gene_plot_sorted <- ko_comm_DESeq_sorted %>%
dplyr::select(stress_genes_sorted$KO) %>%
mutate("Environment" = ko_meta_sorted$Environment)
gene_plot_long_sorted <- gene_plot_sorted %>%
pivot_longer(names(gene_plot)[1:157],
names_to = "Gene", values_to = "Abundance") %>%
mutate(Environment = dplyr::recode_factor(Environment,
"Acid mine drainage" = "Acid mine drainage (n = 33)",
"Cryosphere - soil" = "Cryosphere - soil (n = 27)",
"Cryosphere - water" = "Cryosphere - water (n = 20)",
"Desert" = "Desert (n = 33)",
"Glacial forefield" = "Glacial forefield (n = 60)",
"Hot spring" = "Hot spring (n = 167)",
"Hydrothermal vent" = "Hydrothermal vent (n = 237)",
"Hypersaline" = "Hypersaline (n = 225)",
"Soda lake" = "Soda lake (n = 25)"))
gene_plot_summary_sorted <- gene_plot_long_sorted %>%
group_by(Environment, Gene) %>%
summarise(mean = mean(Abundance),
se = std.error(Abundance))
gene_hm_summary <- gene_plot_summary_sorted %>%
dplyr::select(-se) %>%
pivot_wider(names_from = Environment, values_from = mean) %>%
column_to_rownames(var = "Gene") %>%
t() %>%
as.data.frame() %>%
dplyr::select(stress_genes_sorted$KO) %>%
t() %>%
as.matrix()
rownames(gene_hm_summary) <- stress_genes_sorted$KOsymb
ann_rows <- data.frame(row.names = rownames(gene_hm_summary),
Stress = stress_genes_sorted$Stress)
ann_colors <- list(Stress = c("Alkaline pH" = viridis_pal()(17)[1],
"Cellular" = viridis_pal()(17)[2],
"Chlorine" = viridis_pal()(17)[3],
"Cold" = viridis_pal()(17)[4],
"Environmental" = viridis_pal()(17)[5],
"Environmental-Oxidative" = viridis_pal()(17)[6],
"General" = viridis_pal()(17)[7],
"Granule" = viridis_pal()(17)[8],
"Heat" = viridis_pal()(17)[9],
"Heat-Osmotic" = viridis_pal()(17)[10],
"High pH" = viridis_pal()(17)[11],
"Metal resistance-Zn" = viridis_pal()(17)[12],
"Osmotic" = viridis_pal()(17)[13],
"Osmotic, Low pH" = viridis_pal()(17)[14],
"Oxidative" = viridis_pal()(17)[15],
"pH" = viridis_pal()(17)[16],
"Starvation" = viridis_pal()(17)[17]))
phm1 <- pheatmap(gene_hm_summary,
color = colorRampPalette(rev(brewer.pal(n = 7, name = "RdBu")))(100),
legend = T,
legend_breaks = c(-2, -1, 0, 1, 2, 2.65),
legend_labels = c("-2", "-1", "0", "1", "2", "Abund."),
border_color = NA,
scale = "row",
show_colnames = T,
angle_col = 315,
cluster_rows = F,
cluster_cols = T,
fontsize_row = 4,
annotation_row = ann_rows,
annotation_colors = ann_colors)
save_pheatmap_pdf <- function(x, filename, width = 7, height = 12) {
stopifnot(!missing(x))
stopifnot(!missing(filename))
pdf(filename, width=width, height=height)
grid::grid.newpage()
grid::grid.draw(x$gtable)
dev.off()
}
phm2 <- pheatmap(gene_hm_summary,
color = colorRampPalette(rev(brewer.pal(n = 7, name = "RdBu")))(100),
legend = T,
legend_breaks = c(-2, -1, 0, 1, 2, 2.65),
legend_labels = c("-2", "-1", "0", "1", "2", "Abund."),
border_color = NA,
scale = "row",
show_colnames = T,
angle_col = 315,
cluster_rows = T,
cluster_cols = T,
fontsize_row = 4,
annotation_row = ann_rows,
annotation_colors = ann_colors)
# Figure 6
pheatmap(gene_hm_summary,
color = colorRampPalette(rev(brewer.pal(n = 7, name = "RdBu")))(100),
legend = T,
legend_breaks = c(-2, -1, 0, 1, 2, 2.65),
legend_labels = c("-2", "-1", "0", "1", "2", "Abund."),
border_color = NA,
scale = "row",
show_colnames = T,
angle_col = 315,
cluster_rows = F,
cluster_cols = T,
fontsize_row = 4,
annotation_row = ann_rows,
annotation_colors = ann_colors,
file = "FinalFigs/Figure6.png",
height = 12,
width = 7)
#### _KO Stress ####
# Got list of genes from Quandt Lab
stress_genes <- read_xlsx("Stress_genes_cleaned.xlsx")
#stress_genes <- stress_genes %>%
#  dplyr::select(-Symbol, -Name, -Protein) %>%
#  separate(Definition, into = c("Symbol", "Name"), sep = ";", remove = F) %>%
#  dplyr::select(KO, Definition, Symbol, Name, Stress, Notes)
#write.csv(stress_genes, file = "stress_genes_wDef.csv", row.names = F)
stress_genes <- read.csv("stress_genes_wDef.csv") %>%
filter(KO %in% colnames(ko_comm_DESeq)) %>%
filter(!duplicated(KO))
# Note 158 of 208 KOs are in the dataset
# Note 2 were duplicates. So there are 157 KOs
not_present <- read.csv("stress_genes_wDef.csv") %>%
filter(KO %notin% colnames(ko_comm_DESeq)) %>%
filter(!duplicated(KO))
write.csv(not_present, file = "stress_genes_not_present.csv", row.names = F)
phm1 <- pheatmap(gene_hm_summary,
color = colorRampPalette(rev(brewer.pal(n = 7, name = "RdBu")))(100),
legend = T,
legend_breaks = c(-2, -1, 0, 1, 2, 2.65),
legend_labels = c("-2", "-1", "0", "1", "2", "Abund."),
border_color = NA,
scale = "row",
show_colnames = T,
angle_col = 315,
cluster_rows = F,
cluster_cols = T,
method = "ward.D2"
fontsize_row = 4,
phm1 <- pheatmap(gene_hm_summary,
color = colorRampPalette(rev(brewer.pal(n = 7, name = "RdBu")))(100),
legend = T,
legend_breaks = c(-2, -1, 0, 1, 2, 2.65),
legend_labels = c("-2", "-1", "0", "1", "2", "Abund."),
border_color = NA,
scale = "row",
show_colnames = T,
angle_col = 315,
cluster_rows = F,
cluster_cols = T,
method = "ward.D2",
fontsize_row = 4,
annotation_row = ann_rows,
annotation_colors = ann_colors)
phm1
dev.off()
phm1
citation("gamlss")
citation("PMCMRplus")
citation("cowplot")
