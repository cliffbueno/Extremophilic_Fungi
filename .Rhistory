geom_point(aes(size = richness_KO), alpha = 0.5) +
scale_size(range = c(1, 10)) +
labs(x = paste("PC1: ", pcoa1A1, "%", sep = ""),
y = paste("PC2: ", pcoa1A2, "%", sep = ""),
colour = "Environment",
size = "Number of KOs",
title = "KO Jaccard") +
scale_colour_manual(values = color_mapping) +
xlim(-0.2, 0.29) +
ylim(-0.3, 0.12) +
guides(colour = guide_legend(override.aes = list(alpha = 1, size = 3))) +
theme_bw() +
theme(legend.position = "none",
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
plot.title = element_text(vjust = 0),
panel.grid = element_blank())
g6_ko
plot_grid(g5_ko, g6_ko, ko_pcoa_leg, ncol = 3, rel_widths = c(2.5,2.5,1.1),
labels = c("A", "B"))
#### ___Figure 5 ####
png("FinalFigs/Figure5.png", width = 8.5, height = 5, units = "in", res = 300)
plot_grid(g5_ko, g6_ko, ko_pcoa_leg, ncol = 3, rel_widths = c(2.5,2.5,1.1),
labels = c("A", "B"))
dev.off()
#### _KO750 Taxa ####
# Get the same 44 samples from the KO750 comparison and make PCoA from fungal_CPM_nz
input_fungi_CPM_nz_44 <- filter_data(input_fungi_CPM_nz,
filter_cat = "taxon_oid",
keep_vals = ko_meta_filt$taxon_oid)
# BC
bc <- calc_dm(input_fungi_CPM_nz_44$data_loaded)
set.seed(1150)
adonis2(bc ~ Environment, data = input_fungi_CPM_nz_44$map_loaded) # R2 = 0.48, p = 0.001
adonis2(bc ~ Environment, data = input_fungi_CPM_nz_44$map_loaded) # R2 = 0.49, p = 0.001
anova(betadisper(bc, input_fungi_CPM_nz_44$map_loaded$Environment)) # Dispersion homogeneous
pcoa <- cmdscale(bc, k = nrow(input_fungi_CPM_nz_44$map_loaded) - 1, eig = T)
pcoaA1 <- round((eigenvals(pcoa)/sum(eigenvals(pcoa)))[1]*100, digits = 1)
pcoaA2 <- round((eigenvals(pcoa)/sum(eigenvals(pcoa)))[2]*100, digits = 1)
input_fungi_CPM_nz_44$map_loaded$Axis01 <- scores(pcoa)[,1]
input_fungi_CPM_nz_44$map_loaded$Axis02 <- scores(pcoa)[,2]
micro.hulls <- ddply(input_fungi_CPM_nz_44$map_loaded, c("Environment"), find_hull)
bc44 <- ggplot(input_fungi_CPM_nz_44$map_loaded, aes(Axis01, Axis02)) +
geom_polygon(data = micro.hulls,
aes(colour = Environment, fill = Environment),
alpha = 0.1, show.legend = F) +
geom_point(size = 2, alpha = 0.5, aes(colour = Environment), show.legend = T) +
labs(x = paste("PC1: ", pcoaA1, "%", sep = ""),
y = paste("PC2: ", pcoaA2, "%", sep = ""),
title = "Bray-Curtis",
colour = "Environment") +
scale_colour_manual(values = color_mapping) +
xlim(-0.48, 0.35) +
ylim(-0.31, 0.34) +
guides(colour = guide_legend(override.aes = list(alpha = 1, size = 3))) +
theme_bw() +
theme(legend.position = "right",
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
plot.title = element_text(vjust = 0),
panel.grid = element_blank())
leg44 <- get_legend(bc44)
bc44 <- bc44 + theme(legend.position = "none")
range(input_fungi_CPM_nz_44$map_loaded$Axis01) # -0.41 to 0.29
range(input_fungi_CPM_nz_44$map_loaded$Axis02) # -0.31 to 0.34
jac <- calc_dm(input_fungi_CPM_nz_44$data_loaded, method = "jaccard")
set.seed(1150)
adonis2(jac ~ Environment, data = input_fungi_CPM_nz_44$map_loaded) # R2 = 0.54, p = 0.001
anova(betadisper(jac, input_fungi_CPM_nz_44$map_loaded$Environment)) # Dispersion homogeneous
pcoa <- cmdscale(jac, k = nrow(input_fungi_CPM_nz_44$map_loaded) - 1, eig = T)
pcoaA1 <- round((eigenvals(pcoa)/sum(eigenvals(pcoa)))[1]*100, digits = 1)
pcoaA2 <- round((eigenvals(pcoa)/sum(eigenvals(pcoa)))[2]*100, digits = 1)
input_fungi_CPM_nz_44$map_loaded$Axis01 <- scores(pcoa)[,1]
input_fungi_CPM_nz_44$map_loaded$Axis02 <- scores(pcoa)[,2]
micro.hulls <- ddply(input_fungi_CPM_nz_44$map_loaded, c("Environment"), find_hull)
jac44 <- ggplot(input_fungi_CPM_nz_44$map_loaded, aes(Axis01, Axis02)) +
geom_polygon(data = micro.hulls,
aes(colour = Environment, fill = Environment),
alpha = 0.1, show.legend = F) +
geom_point(size = 2, alpha = 0.5, aes(colour = Environment), show.legend = T) +
labs(x = paste("PC1: ", pcoaA1, "%", sep = ""),
y = paste("PC2: ", pcoaA2, "%", sep = ""),
title = "Jaccard") +
scale_colour_manual(values = color_mapping) +
xlim(-0.48, 0.35) +
ylim(-0.31, 0.34) +
guides(colour = guide_legend(override.aes = list(alpha = 1, size = 3))) +
theme_bw() +
theme(legend.position = "none",
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
plot.title = element_text(vjust = 0),
panel.grid = element_blank())
jac44
range(input_fungi_CPM_nz_44$map_loaded$Axis01) # -0.48 to 0.35
range(input_fungi_CPM_nz_44$map_loaded$Axis02) # -0.16 to 0.18
plot_grid(bc44, jac44, leg44, ncol = 3, rel_widths = c(2.5,2.5,1.1),
labels = c("A", "B"))
pcoa <- cmdscale(bc, k = nrow(input_fungi_CPM_nz_44$map_loaded) - 1, eig = T)
pcoaA1 <- round((eigenvals(pcoa)/sum(eigenvals(pcoa)))[1]*100, digits = 1)
pcoaA2 <- round((eigenvals(pcoa)/sum(eigenvals(pcoa)))[2]*100, digits = 1)
input_fungi_CPM_nz_44$map_loaded$Axis01 <- scores(pcoa)[,1]
input_fungi_CPM_nz_44$map_loaded$Axis02 <- scores(pcoa)[,2]
micro.hulls <- ddply(input_fungi_CPM_nz_44$map_loaded, c("Environment"), find_hull)
bc44 <- ggplot(input_fungi_CPM_nz_44$map_loaded, aes(Axis01, Axis02)) +
geom_polygon(data = micro.hulls,
aes(colour = Environment, fill = Environment),
alpha = 0.1, show.legend = F) +
geom_point(size = 2, alpha = 0.5, shape = 16, aes(colour = Environment), show.legend = T) +
labs(x = paste("PC1: ", pcoaA1, "%", sep = ""),
y = paste("PC2: ", pcoaA2, "%", sep = ""),
title = "Bray-Curtis",
colour = "Environment") +
scale_colour_manual(values = color_mapping) +
xlim(-0.48, 0.35) +
ylim(-0.31, 0.34) +
guides(colour = guide_legend(override.aes = list(alpha = 1, size = 3))) +
theme_bw() +
theme(legend.position = "right",
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
plot.title = element_text(vjust = 0),
panel.grid = element_blank())
leg44 <- get_legend(bc44)
bc44 <- bc44 + theme(legend.position = "none")
range(input_fungi_CPM_nz_44$map_loaded$Axis01) # -0.41 to 0.29
range(input_fungi_CPM_nz_44$map_loaded$Axis02) # -0.31 to 0.34
pcoa <- cmdscale(jac, k = nrow(input_fungi_CPM_nz_44$map_loaded) - 1, eig = T)
pcoaA1 <- round((eigenvals(pcoa)/sum(eigenvals(pcoa)))[1]*100, digits = 1)
pcoaA2 <- round((eigenvals(pcoa)/sum(eigenvals(pcoa)))[2]*100, digits = 1)
input_fungi_CPM_nz_44$map_loaded$Axis01 <- scores(pcoa)[,1]
input_fungi_CPM_nz_44$map_loaded$Axis02 <- scores(pcoa)[,2]
micro.hulls <- ddply(input_fungi_CPM_nz_44$map_loaded, c("Environment"), find_hull)
jac44 <- ggplot(input_fungi_CPM_nz_44$map_loaded, aes(Axis01, Axis02)) +
geom_polygon(data = micro.hulls,
aes(colour = Environment, fill = Environment),
alpha = 0.1, show.legend = F) +
geom_point(size = 2, alpha = 0.5, shape = 16, aes(colour = Environment), show.legend = T) +
labs(x = paste("PC1: ", pcoaA1, "%", sep = ""),
y = paste("PC2: ", pcoaA2, "%", sep = ""),
title = "Jaccard") +
scale_colour_manual(values = color_mapping) +
xlim(-0.48, 0.35) +
ylim(-0.31, 0.34) +
guides(colour = guide_legend(override.aes = list(alpha = 1, size = 3))) +
theme_bw() +
theme(legend.position = "none",
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
plot.title = element_text(vjust = 0),
panel.grid = element_blank())
jac44
plot_grid(bc44, jac44, leg44, ncol = 3, rel_widths = c(2.5,2.5,1.1),
labels = c("A", "B"))
#### ___Figure S6 ####
png("FinalFigs/FigureS6.png", width = 8.5, height = 5, units = "in", res = 300)
plot_grid(bc44, jac44, leg44, ncol = 3, rel_widths = c(2.5,2.5,1.1),
labels = c("A", "B"))
dev.off()
bc_ko <- vegdist(ko_comm_DESeq_filt, method = "bray")
pcoa_ko <- cmdscale(bc_ko, k = nrow(ko_meta_filt) - 1, eig = T)
pcoaA1 <- round((eigenvals(pcoa_ko)/sum(eigenvals(pcoa_ko)))[1]*100, digits = 1)
pcoaA2 <- round((eigenvals(pcoa_ko)/sum(eigenvals(pcoa_ko)))[2]*100, digits = 1)
ko_meta_filt$Axis01 <- scores(pcoa_ko)[,1]
ko_meta_filt$Axis02 <- scores(pcoa_ko)[,2]
range(ko_meta_filt$Axis01)
range(ko_meta_filt$Axis02)
micro.hulls <- ddply(ko_meta_filt, c("Environment"), find_hull)
g5_ko <- ggplot(ko_meta_filt, aes(Axis01, Axis02, colour = Environment)) +
geom_polygon(data = micro.hulls, aes(colour = Environment, fill = Environment),
alpha = 0.1, show.legend = F) +
geom_point(aes(size = richness_KO), shape = 16, alpha = 0.5) +
scale_size(range = c(1, 10)) +
labs(x = paste("PC1: ", pcoaA1, "%", sep = ""),
y = paste("PC2: ", pcoaA2, "%", sep = ""),
colour = "Environment",
size = "Number of KOs",
title = "KO Bray-Curtis") +
scale_colour_manual(values = color_mapping) +
xlim(-0.2, 0.29) +
ylim(-0.3, 0.12) +
guides(colour = guide_legend(override.aes = list(alpha = 1, size = 3))) +
theme_bw() +
theme(legend.position = "right",
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
plot.title = element_text(vjust = 0),
panel.grid = element_blank())
g5_ko
ko_pcoa_leg <- get_legend(g5_ko)
g5_ko <- g5_ko +
theme(legend.position = "none")
jac_ko <- vegdist(ko_comm_DESeq_filt, method = "jaccard")
pcoa1_ko <- cmdscale(jac_ko, k = nrow(ko_meta_filt) - 1, eig = T)
pcoa1A1 <- round((eigenvals(pcoa1_ko)/sum(eigenvals(pcoa1_ko)))[1]*100, digits = 1)
pcoa1A2 <- round((eigenvals(pcoa1_ko)/sum(eigenvals(pcoa1_ko)))[2]*100, digits = 1)
ko_meta_filt$Axis01j <- scores(pcoa1_ko)[,1]
ko_meta_filt$Axis02j <- scores(pcoa1_ko)[,2]
range(ko_meta_filt$Axis01j)
range(ko_meta_filt$Axis02j)
micro.hullsj <- ddply(ko_meta_filt, c("Environment"), find_hullj)
g6_ko <- ggplot(ko_meta_filt, aes(Axis01j, Axis02j, colour = Environment)) +
geom_polygon(data = micro.hullsj, aes(colour = Environment, fill = Environment),
alpha = 0.1, show.legend = F) +
geom_point(aes(size = richness_KO), shape = 16, alpha = 0.5) +
scale_size(range = c(1, 10)) +
labs(x = paste("PC1: ", pcoa1A1, "%", sep = ""),
y = paste("PC2: ", pcoa1A2, "%", sep = ""),
colour = "Environment",
size = "Number of KOs",
title = "KO Jaccard") +
scale_colour_manual(values = color_mapping) +
xlim(-0.2, 0.29) +
ylim(-0.3, 0.12) +
guides(colour = guide_legend(override.aes = list(alpha = 1, size = 3))) +
theme_bw() +
theme(legend.position = "none",
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
plot.title = element_text(vjust = 0),
panel.grid = element_blank())
g6_ko
#### ___Figure 5 ####
png("FinalFigs/Figure5.png", width = 8.5, height = 5, units = "in", res = 300)
plot_grid(g5_ko, g6_ko, ko_pcoa_leg, ncol = 3, rel_widths = c(2.5,2.5,1.1),
labels = c("A", "B"))
dev.off()
pcoa_ko <- cmdscale(bc_ko, k = nrow(ko_meta_filt) - 1, eig = T)
pcoaA1 <- round((eigenvals(pcoa_ko)/sum(eigenvals(pcoa_ko)))[1]*100, digits = 1)
pcoaA2 <- round((eigenvals(pcoa_ko)/sum(eigenvals(pcoa_ko)))[2]*100, digits = 1)
ko_meta_filt$Axis01 <- scores(pcoa_ko)[,1]
ko_meta_filt$Axis02 <- scores(pcoa_ko)[,2]
range(ko_meta_filt$Axis01)
range(ko_meta_filt$Axis02)
micro.hulls <- ddply(ko_meta_filt, c("Environment"), find_hull)
g5_ko <- ggplot(ko_meta_filt, aes(Axis01, Axis02, colour = Environment)) +
geom_polygon(data = micro.hulls, aes(colour = Environment, fill = Environment),
alpha = 0.1, show.legend = F) +
geom_point(aes(size = richness_KO), shape = 16, alpha = 0.75) +
scale_size(range = c(1, 10)) +
labs(x = paste("PC1: ", pcoaA1, "%", sep = ""),
y = paste("PC2: ", pcoaA2, "%", sep = ""),
colour = "Environment",
size = "Number of KOs",
title = "KO Bray-Curtis") +
scale_fill_manual(values = color_mapping) +
scale_colour_manual(values = color_mapping) +
xlim(-0.2, 0.29) +
ylim(-0.3, 0.12) +
guides(colour = guide_legend(override.aes = list(alpha = 1, size = 3))) +
theme_bw() +
theme(legend.position = "right",
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
plot.title = element_text(vjust = 0),
panel.grid = element_blank())
g5_ko
ko_pcoa_leg <- get_legend(g5_ko)
g5_ko <- g5_ko +
theme(legend.position = "none")
jac_ko <- vegdist(ko_comm_DESeq_filt, method = "jaccard")
pcoa1_ko <- cmdscale(jac_ko, k = nrow(ko_meta_filt) - 1, eig = T)
pcoa1A1 <- round((eigenvals(pcoa1_ko)/sum(eigenvals(pcoa1_ko)))[1]*100, digits = 1)
pcoa1A2 <- round((eigenvals(pcoa1_ko)/sum(eigenvals(pcoa1_ko)))[2]*100, digits = 1)
ko_meta_filt$Axis01j <- scores(pcoa1_ko)[,1]
ko_meta_filt$Axis02j <- scores(pcoa1_ko)[,2]
range(ko_meta_filt$Axis01j)
range(ko_meta_filt$Axis02j)
micro.hullsj <- ddply(ko_meta_filt, c("Environment"), find_hullj)
g6_ko <- ggplot(ko_meta_filt, aes(Axis01j, Axis02j, colour = Environment)) +
geom_polygon(data = micro.hullsj, aes(colour = Environment, fill = Environment),
alpha = 0.1, show.legend = F) +
geom_point(aes(size = richness_KO), shape = 16, alpha = 0.75) +
scale_size(range = c(1, 10)) +
labs(x = paste("PC1: ", pcoa1A1, "%", sep = ""),
y = paste("PC2: ", pcoa1A2, "%", sep = ""),
colour = "Environment",
size = "Number of KOs",
title = "KO Jaccard") +
scale_fill_manual(values = color_mapping) +
scale_colour_manual(values = color_mapping) +
xlim(-0.2, 0.29) +
ylim(-0.3, 0.12) +
guides(colour = guide_legend(override.aes = list(alpha = 1, size = 3))) +
theme_bw() +
theme(legend.position = "none",
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
plot.title = element_text(vjust = 0),
panel.grid = element_blank())
g6_ko
plot_grid(g5_ko, g6_ko, ko_pcoa_leg, ncol = 3, rel_widths = c(2.5,2.5,1.1),
labels = c("A", "B"))
#### ___Figure 5 ####
png("FinalFigs/Figure5.png", width = 8.5, height = 5, units = "in", res = 300)
plot_grid(g5_ko, g6_ko, ko_pcoa_leg, ncol = 3, rel_widths = c(2.5,2.5,1.1),
labels = c("A", "B"))
dev.off()
pcoa <- cmdscale(bc, k = nrow(input_fungi_CPM_nz_44$map_loaded) - 1, eig = T)
pcoaA1 <- round((eigenvals(pcoa)/sum(eigenvals(pcoa)))[1]*100, digits = 1)
pcoaA2 <- round((eigenvals(pcoa)/sum(eigenvals(pcoa)))[2]*100, digits = 1)
input_fungi_CPM_nz_44$map_loaded$Axis01 <- scores(pcoa)[,1]
input_fungi_CPM_nz_44$map_loaded$Axis02 <- scores(pcoa)[,2]
micro.hulls <- ddply(input_fungi_CPM_nz_44$map_loaded, c("Environment"), find_hull)
bc44 <- ggplot(input_fungi_CPM_nz_44$map_loaded, aes(Axis01, Axis02)) +
geom_polygon(data = micro.hulls,
aes(colour = Environment, fill = Environment),
alpha = 0.1, show.legend = F) +
geom_point(size = 2, alpha = 0.75, shape = 16, aes(colour = Environment), show.legend = T) +
labs(x = paste("PC1: ", pcoaA1, "%", sep = ""),
y = paste("PC2: ", pcoaA2, "%", sep = ""),
title = "Bray-Curtis",
colour = "Environment") +
scale_colour_manual(values = color_mapping) +
xlim(-0.48, 0.35) +
ylim(-0.31, 0.34) +
guides(colour = guide_legend(override.aes = list(alpha = 1, size = 3))) +
theme_bw() +
theme(legend.position = "right",
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
plot.title = element_text(vjust = 0),
panel.grid = element_blank())
leg44 <- get_legend(bc44)
bc44 <- bc44 + theme(legend.position = "none")
range(input_fungi_CPM_nz_44$map_loaded$Axis01) # -0.41 to 0.29
range(input_fungi_CPM_nz_44$map_loaded$Axis02) # -0.31 to 0.34
jac <- calc_dm(input_fungi_CPM_nz_44$data_loaded, method = "jaccard")
set.seed(1150)
adonis2(jac ~ Environment, data = input_fungi_CPM_nz_44$map_loaded) # R2 = 0.54, p = 0.001
anova(betadisper(jac, input_fungi_CPM_nz_44$map_loaded$Environment)) # Dispersion homogeneous
pcoa <- cmdscale(jac, k = nrow(input_fungi_CPM_nz_44$map_loaded) - 1, eig = T)
pcoaA1 <- round((eigenvals(pcoa)/sum(eigenvals(pcoa)))[1]*100, digits = 1)
pcoaA2 <- round((eigenvals(pcoa)/sum(eigenvals(pcoa)))[2]*100, digits = 1)
input_fungi_CPM_nz_44$map_loaded$Axis01 <- scores(pcoa)[,1]
input_fungi_CPM_nz_44$map_loaded$Axis02 <- scores(pcoa)[,2]
micro.hulls <- ddply(input_fungi_CPM_nz_44$map_loaded, c("Environment"), find_hull)
jac44 <- ggplot(input_fungi_CPM_nz_44$map_loaded, aes(Axis01, Axis02)) +
geom_polygon(data = micro.hulls,
aes(colour = Environment, fill = Environment),
alpha = 0.1, show.legend = F) +
geom_point(size = 2, alpha = 0.75, shape = 16, aes(colour = Environment), show.legend = T) +
labs(x = paste("PC1: ", pcoaA1, "%", sep = ""),
y = paste("PC2: ", pcoaA2, "%", sep = ""),
title = "Jaccard") +
scale_colour_manual(values = color_mapping) +
xlim(-0.48, 0.35) +
ylim(-0.31, 0.34) +
guides(colour = guide_legend(override.aes = list(alpha = 1, size = 3))) +
theme_bw() +
theme(legend.position = "none",
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
plot.title = element_text(vjust = 0),
panel.grid = element_blank())
jac44
range(input_fungi_CPM_nz_44$map_loaded$Axis01) # -0.48 to 0.35
range(input_fungi_CPM_nz_44$map_loaded$Axis02) # -0.16 to 0.18
pcoa <- cmdscale(bc, k = nrow(input_fungi_CPM_nz_44$map_loaded) - 1, eig = T)
pcoaA1 <- round((eigenvals(pcoa)/sum(eigenvals(pcoa)))[1]*100, digits = 1)
pcoaA2 <- round((eigenvals(pcoa)/sum(eigenvals(pcoa)))[2]*100, digits = 1)
input_fungi_CPM_nz_44$map_loaded$Axis01 <- scores(pcoa)[,1]
input_fungi_CPM_nz_44$map_loaded$Axis02 <- scores(pcoa)[,2]
micro.hulls <- ddply(input_fungi_CPM_nz_44$map_loaded, c("Environment"), find_hull)
bc44 <- ggplot(input_fungi_CPM_nz_44$map_loaded, aes(Axis01, Axis02)) +
geom_polygon(data = micro.hulls,
aes(colour = Environment, fill = Environment),
alpha = 0.1, show.legend = F) +
geom_point(size = 2, alpha = 0.75, shape = 16, aes(colour = Environment), show.legend = T) +
labs(x = paste("PC1: ", pcoaA1, "%", sep = ""),
y = paste("PC2: ", pcoaA2, "%", sep = ""),
title = "Bray-Curtis",
colour = "Environment") +
scale_fill_manual(values = color_mapping) +
scale_colour_manual(values = color_mapping) +
xlim(-0.48, 0.35) +
ylim(-0.31, 0.34) +
guides(colour = guide_legend(override.aes = list(alpha = 1, size = 3))) +
theme_bw() +
theme(legend.position = "right",
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
plot.title = element_text(vjust = 0),
panel.grid = element_blank())
leg44 <- get_legend(bc44)
bc44 <- bc44 + theme(legend.position = "none")
range(input_fungi_CPM_nz_44$map_loaded$Axis01) # -0.41 to 0.29
range(input_fungi_CPM_nz_44$map_loaded$Axis02) # -0.31 to 0.34
jac <- calc_dm(input_fungi_CPM_nz_44$data_loaded, method = "jaccard")
set.seed(1150)
adonis2(jac ~ Environment, data = input_fungi_CPM_nz_44$map_loaded) # R2 = 0.54, p = 0.001
anova(betadisper(jac, input_fungi_CPM_nz_44$map_loaded$Environment)) # Dispersion homogeneous
pcoa <- cmdscale(jac, k = nrow(input_fungi_CPM_nz_44$map_loaded) - 1, eig = T)
pcoaA1 <- round((eigenvals(pcoa)/sum(eigenvals(pcoa)))[1]*100, digits = 1)
pcoaA2 <- round((eigenvals(pcoa)/sum(eigenvals(pcoa)))[2]*100, digits = 1)
input_fungi_CPM_nz_44$map_loaded$Axis01 <- scores(pcoa)[,1]
input_fungi_CPM_nz_44$map_loaded$Axis02 <- scores(pcoa)[,2]
micro.hulls <- ddply(input_fungi_CPM_nz_44$map_loaded, c("Environment"), find_hull)
jac44 <- ggplot(input_fungi_CPM_nz_44$map_loaded, aes(Axis01, Axis02)) +
geom_polygon(data = micro.hulls,
aes(colour = Environment, fill = Environment),
alpha = 0.1, show.legend = F) +
geom_point(size = 2, alpha = 0.75, shape = 16, aes(colour = Environment), show.legend = T) +
labs(x = paste("PC1: ", pcoaA1, "%", sep = ""),
y = paste("PC2: ", pcoaA2, "%", sep = ""),
title = "Jaccard") +
scale_fill_manual(values = color_mapping) +
scale_colour_manual(values = color_mapping) +
xlim(-0.48, 0.35) +
ylim(-0.31, 0.34) +
guides(colour = guide_legend(override.aes = list(alpha = 1, size = 3))) +
theme_bw() +
theme(legend.position = "none",
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
plot.title = element_text(vjust = 0),
panel.grid = element_blank())
jac44
range(input_fungi_CPM_nz_44$map_loaded$Axis01) # -0.48 to 0.35
range(input_fungi_CPM_nz_44$map_loaded$Axis02) # -0.16 to 0.18
jac44 <- ggplot(input_fungi_CPM_nz_44$map_loaded, aes(Axis01, Axis02)) +
geom_polygon(data = micro.hulls,
aes(colour = Environment, fill = Environment),
alpha = 0.1, show.legend = F) +
geom_point(size = 3, alpha = 0.75, shape = 16, aes(colour = Environment), show.legend = T) +
labs(x = paste("PC1: ", pcoaA1, "%", sep = ""),
y = paste("PC2: ", pcoaA2, "%", sep = ""),
title = "Jaccard") +
scale_fill_manual(values = color_mapping) +
scale_colour_manual(values = color_mapping) +
xlim(-0.48, 0.35) +
ylim(-0.31, 0.34) +
guides(colour = guide_legend(override.aes = list(alpha = 1, size = 3))) +
theme_bw() +
theme(legend.position = "none",
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
plot.title = element_text(vjust = 0),
panel.grid = element_blank())
jac44
pcoa <- cmdscale(bc, k = nrow(input_fungi_CPM_nz_44$map_loaded) - 1, eig = T)
pcoaA1 <- round((eigenvals(pcoa)/sum(eigenvals(pcoa)))[1]*100, digits = 1)
pcoaA2 <- round((eigenvals(pcoa)/sum(eigenvals(pcoa)))[2]*100, digits = 1)
input_fungi_CPM_nz_44$map_loaded$Axis01 <- scores(pcoa)[,1]
input_fungi_CPM_nz_44$map_loaded$Axis02 <- scores(pcoa)[,2]
micro.hulls <- ddply(input_fungi_CPM_nz_44$map_loaded, c("Environment"), find_hull)
bc44 <- ggplot(input_fungi_CPM_nz_44$map_loaded, aes(Axis01, Axis02)) +
geom_polygon(data = micro.hulls,
aes(colour = Environment, fill = Environment),
alpha = 0.1, show.legend = F) +
geom_point(size = 3, alpha = 0.75, shape = 16, aes(colour = Environment), show.legend = T) +
labs(x = paste("PC1: ", pcoaA1, "%", sep = ""),
y = paste("PC2: ", pcoaA2, "%", sep = ""),
title = "Bray-Curtis",
colour = "Environment") +
scale_fill_manual(values = color_mapping) +
scale_colour_manual(values = color_mapping) +
xlim(-0.48, 0.35) +
ylim(-0.31, 0.34) +
guides(colour = guide_legend(override.aes = list(alpha = 1, size = 3))) +
theme_bw() +
theme(legend.position = "right",
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
plot.title = element_text(vjust = 0),
panel.grid = element_blank())
leg44 <- get_legend(bc44)
bc44 <- bc44 + theme(legend.position = "none")
range(input_fungi_CPM_nz_44$map_loaded$Axis01) # -0.41 to 0.29
range(input_fungi_CPM_nz_44$map_loaded$Axis02) # -0.31 to 0.34
jac <- calc_dm(input_fungi_CPM_nz_44$data_loaded, method = "jaccard")
set.seed(1150)
adonis2(jac ~ Environment, data = input_fungi_CPM_nz_44$map_loaded) # R2 = 0.54, p = 0.001
anova(betadisper(jac, input_fungi_CPM_nz_44$map_loaded$Environment)) # Dispersion homogeneous
pcoa <- cmdscale(jac, k = nrow(input_fungi_CPM_nz_44$map_loaded) - 1, eig = T)
pcoaA1 <- round((eigenvals(pcoa)/sum(eigenvals(pcoa)))[1]*100, digits = 1)
pcoaA2 <- round((eigenvals(pcoa)/sum(eigenvals(pcoa)))[2]*100, digits = 1)
input_fungi_CPM_nz_44$map_loaded$Axis01 <- scores(pcoa)[,1]
input_fungi_CPM_nz_44$map_loaded$Axis02 <- scores(pcoa)[,2]
micro.hulls <- ddply(input_fungi_CPM_nz_44$map_loaded, c("Environment"), find_hull)
jac44 <- ggplot(input_fungi_CPM_nz_44$map_loaded, aes(Axis01, Axis02)) +
geom_polygon(data = micro.hulls,
aes(colour = Environment, fill = Environment),
alpha = 0.1, show.legend = F) +
geom_point(size = 3, alpha = 0.75, shape = 16, aes(colour = Environment), show.legend = T) +
labs(x = paste("PC1: ", pcoaA1, "%", sep = ""),
y = paste("PC2: ", pcoaA2, "%", sep = ""),
title = "Jaccard") +
scale_fill_manual(values = color_mapping) +
scale_colour_manual(values = color_mapping) +
xlim(-0.48, 0.35) +
ylim(-0.31, 0.34) +
guides(colour = guide_legend(override.aes = list(alpha = 1, size = 3))) +
theme_bw() +
theme(legend.position = "none",
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
plot.title = element_text(vjust = 0),
panel.grid = element_blank())
jac44
range(input_fungi_CPM_nz_44$map_loaded$Axis01) # -0.48 to 0.35
range(input_fungi_CPM_nz_44$map_loaded$Axis02) # -0.16 to 0.18
plot_grid(bc44, jac44, leg44, ncol = 3, rel_widths = c(2.5,2.5,1.1),
labels = c("A", "B"))
#### ___Figure S6 ####
png("FinalFigs/FigureS6.png", width = 8.5, height = 5, units = "in", res = 300)
plot_grid(bc44, jac44, leg44, ncol = 3, rel_widths = c(2.5,2.5,1.1),
labels = c("A", "B"))
dev.off()
runApp("App-1")
library(shiny)
runApp("App-1")
